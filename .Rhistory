#tree 꾸미기
install.packages("rattle")
install.packages("rpart.plot")
library(rattle)
library(rpart.plot)
library(RColorBrewer)
rpart.plot(hmeqrpart)
fancyRpartPlot(hmeqrpart)
is it true???
setwd("/Volumes/sparknas712.synology.me/home/Drive/Spark/AIBI/Data mining/조모임")
augtrain<-read.csv("aug_train.csv", header = T)
str(augtrain)
head(augtrain,3);tail(augtrain,3)
augtest<-read.csv("aug_test.csv", header = T)
str(augtest)
library(reshape)
augtrain<-as.data.frame(augtrain)
target<-as.factor(augtrain[,14])
augtrain<-cbind(target,augtrain[,2:13])
str(augtrain)
augtest<-as.data.frame(augtest)
target<-as.factor(augtest[,13])
augtest<-cbind(target,augtest[,2:12])
str(augtest)
augtest
library(tree)
tree1<-tree(target~., data = augtrain, split = c("deviance"),
na.action = na.pass,
control = tree.control(nobs = nrow(augtrain),
minsize = 100,
mindev = 0.05))
plot(tree1)
text(tree1)
print(tree1)
tree1<-tree(target~., data = augtrain, split = c("deviance"),
na.action = na.pass,
control = tree.control(nobs = nrow(augtrain),
minsize = 10,
mindev = 0.0005))
plot(tree1)
text(tree1)
print(tree1)
cv.tree1<-cv.tree(tree1, FUN=prune.misclass, K=100)
cv.tree1<-cv.tree(tree1, FUN=prune.misclass, K=50)
# 검증 데이터가 천개가 있으면 랜덤하게 10개의 그룹으로 나뉘어서 교차검증함
# cross-valadation
warning()
plot(cv.tree1)
